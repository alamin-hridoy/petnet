<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="{{ assetHash "/css/app.min.css" }}">
    <title>List of companies</title>
</head>

<body class="font-sans">
    <div>
        <div class="flex">
            <!-- sidebar-left-start -->
            <div class="bg-petnetblue w-32 min-h-screen">
                <div class="min-h-screen">
                    <img src="{{ assetHash "/images/DRP-Vertical.svg" }}" class="mx-auto my-5">
                    <!-- Sidebar menu start -->
                    {{ template "admin-sidenav-menu.html" dict "Type" "transaction-list" "Data" .}}
                    <!-- Sidebar menu end -->
                </div>
            </div>
            <!-- sidebarleft-end -->

            <!-- top-header-start -->
            <div class="min-h-screen w-full flex bg-petnetgray ">
                <div class="w-full">
                    <div class="px-6 lg:px-8 pt-10 pb-4  bg-white border-b relative z-10">
                        {{ template "top-header.html" .}}
                        <div class="mb-4">
                            <h2 class="text-4xl text-petnetblue">List of Companies</h2>
                        </div>
                        <div class="flex flex-wrap items-center justify-between">
                            <div class="border w-1/3 flex rounded-l">
                                <input type="text" value="{{.SearchTerm}}" id="search" placeholder="Search for company"
                                    class="w-full h-12 p-4 bg-petnetgray focus:outline-none">
                                <button class="bg-petnetblue text-white rounded-r p-3 searchbtn">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- top-header-end -->
                    <!-- table-start -->
                    <div>
                        <table class="w-full">
                            <thead class="bg-white shadow-md relative z-10">
                                <tr class="">
                                    <th class="text-left pl-8 py-3 w-1/3">
                                        <div class="relative dropdown appearance-none">
                                            <button class="dropdown-toggle flex items-center"
                                                onclick="dropdownToggle(event)">
                                                <p class="pr-4 font-semibold text-lg leading-4">Company Name</p>
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
                                                    viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2" d="M19 9l-7 7-7-7" />
                                                </svg>
                                            </button>
                                            <div id="openComDropdown" class="absolute -right-4 top-12 hidden">
                                                <div
                                                    class="transform skew-y-12 skew-x-12 rotate-45 w-6 h-6 absolute ml-auto top-0 right-4 shadow bg-white z-10">
                                                </div>
                                                <div class="shadow absolute top-3 -right-2 rounded">
                                                    <div class="relative z-20 px-3 py-4 w-36 bg-white rounded">
                                                        <ul>
                                                            <li class="text-gray-500 w-full mb-2 text-center text-sm">
                                                                ORDER
                                                            </li>
                                                            <li class="flex items-center mb-2"
                                                                onclick="orderBy('company','asc')">
                                                                <input id="radio-asc" type="radio" value="asc"
                                                                    class="hidden list-custom-input" />
                                                                <label for="radio-asc"
                                                                    class="flex w-full items-center cursor-pointer ml-2 text-md">
                                                                    <span
                                                                        class="w-6 h-4 flex items-center inline-block mr-2 text-lg flex-no-shrink">
                                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                                            class="h-4 w-4" fill="none"
                                                                            viewBox="0 0 24 24" stroke="currentColor">
                                                                            <path stroke-linecap="round"
                                                                                stroke-linejoin="round" stroke-width="2"
                                                                                d="M5 13l4 4L19 7" />
                                                                        </svg>
                                                                    </span>
                                                                    A to Z
                                                                </label>
                                                            </li>
                                                            <li class="flex items-center"
                                                                onclick="orderBy('company','desc')">
                                                                <input id="radio-desc" type="radio" value="desc"
                                                                    class="hidden list-custom-input" />
                                                                <label for="radio-desc"
                                                                    class="flex w-full items-center cursor-pointer ml-2 text-md">
                                                                    <span
                                                                        class="w-6 h-4 flex items-center inline-block mr-2 text-lg flex-no-shrink">
                                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                                            class="h-4 w-4" fill="none"
                                                                            viewBox="0 0 24 24" stroke="currentColor">
                                                                            <path stroke-linecap="round"
                                                                                stroke-linejoin="round" stroke-width="2"
                                                                                d="M5 13l4 4L19 7" />
                                                                        </svg>
                                                                    </span>
                                                                    Z to A
                                                                </label>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </th>
                                    <th class="text-left py-3 font-semibold text-lg leading-4 w-1/3">
                                        Email
                                    </th>
                                    <th scope="col"
                                        class="font-semibold text-lg leading-4 pl-44 py-3 text-left w-1/3 font-semibold tracking-wider text-lg">
                                        Actions
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="bg-white ">
                                {{range .TransactionApplicants}}
                                <tr class="border-b">
                                    <td
                                        class="pl-8 py-4 whitespace-nowrap font-extrabold text-petnetblue font-extrabold text-lg leading-6">
                                        {{.CompanyName}}
                                    </td>
                                    <td
                                        class="py-4 whitespace-nowrap font-extrabold text-petnetblue font-extrabold text-lg leading-6">
                                        {{.User.Email}}
                                    </td>
                                    <td
                                        class="pl-44 py-4 whitespace-nowrap font-extrabold text-petnetlightblue font-medium text-lg leading-6">
                                        <a class="text-petnetlightblue" href="/dashboard/transactionslist/{{.OrgID}}">
                                            Details
                                        </a>
                                    </td>
                                </tr>
                                {{end}}
                            </tbody>
                        </table>
                        <div class="text-gray-500 text-center bg-white py-8 flex justify-between sm:px-8">
                            <div class="sm:block hidden pl-16"></div>
                            <p class="flex items-center pl-80 hidden sm:block"> Showing
                                {{len .TransactionApplicants}} out of
                                {{.PaginationData.Total}} companies</p>
                            <div class="flex justify-between sm:justify-end items-center w-full sm:w-1/2 space-x-3">
                                {{if ne .PaginationData.Total 0}}
                                <a {{if .PaginationData.Prev}}href="{{.PaginationData.Prev.URL}}" {{end}}>
                                    <button {{if eq .PaginationData.CurrentPage 1}} disabled {{end}}
                                        {{if .PaginationData.Prev}}
                                        class="relative inline-flex items-center px-4 py-2 rounded border border-gray-400 bg-white text-sm font-medium text-petnetblue hover:bg-gray-50"
                                        {{else}}
                                        class="relative inline-flex items-center px-4 py-2 rounded border border-gray-400 text-sm font-medium text-gray-500 bg-gray-50"
                                        {{end}}>
                                        Previous
                                    </button>
                                </a>
                                {{end}}
                                <div class="hidden sm:inline-block">
                                    {{range .PaginationData.Pages}}
                                    {{if .Order}}
                                    <a href="{{.URL}}"
                                        class="{{if .Current}}font-bold bg-petnetblue text-white {{else}}text-petnetblue{{end}} z-10 b relative inline-flex items-center px-4 py-2 text-sm font-medium hover:bg-petnetblue hover:text-white">{{.Order}}</a>
                                    {{else}}
                                    <a href="" class="inline-block mr-4 hover:text-blue-dark-5">...</a>
                                    {{end}}
                                    {{end}}
                                </div>
                                <div class="sm:hidden block">
                                    Page {{.PaginationData.CurrentPage}} of
                                    {{countPaginate .PaginationData.Total .PaginationData.PerPage}}
                                </div>
                                {{if ne .PaginationData.Total 0}}
                                <a {{if .PaginationData.Next}}href="{{.PaginationData.Next.URL}}" {{end}}>
                                    <button
                                        {{if eq .PaginationData.CurrentPage (countPaginate .PaginationData.Total .PaginationData.PerPage)}}
                                        disabled {{end}} {{if .PaginationData.Next}}
                                        class="relative inline-flex items-center px-4 py-2 rounded border border-gray-400  bg-white text-sm font-medium text-petnetblue hover:bg-gray-50"
                                        {{else}}
                                        class="relative inline-flex items-center px-4 py-2 rounded border border-gray-400  bg-white text-sm font-medium text-gray-500 bg-gray-50"
                                        {{end}}>Next

                                    </button>
                                </a>
                                {{end}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <script>
        const params = new URLSearchParams(window.location.search)

        function search() {
            let searchTerm = document.getElementById("search").value;
            if (params.has("search-term")) {
                params.delete("search-term");
            }
            params.append("search-term", searchTerm);
            if (params.has("page")) {
                params.delete("page");
            }
            window.location.search = params.toString();
        }

        function dropdownToggle(event) {
            let targetItem = event.target;
            while (!targetItem.classList.contains('dropdown-toggle')) {
                targetItem = targetItem.parentElement;
            }
            targetItem = targetItem.nextElementSibling;

            if (targetItem.classList.contains('hidden')) {
                targetItem.classList.remove("hidden");
            } else {
                targetItem.classList.add("hidden");
            }
            let x = document.getElementsByClassName("dropdown-item");
            for (let i = 0; i < x.length; i++) {
                if (x[i] != targetItem) {
                    x[i].classList.add("hidden")
                }
            }
        }

        function toggleTopButton(id) {
            let getDropdownItem = document.getElementById(id)
            let isHiddenClass = getDropdownItem.classList.contains('hidden');
            if (!isHiddenClass) {
                getDropdownItem.classList.add("hidden");
            } else {
                getDropdownItem.classList.remove("hidden");
            }
        }

        function orderBy(cloumn, type) {
            params.set("sort", type);
            params.set("sort_column", cloumn);

            if (params.has("page")) {
                params.delete("page")
            }
            window.location.search = params.toString();
        }
        window.onload = function () {
            if (params.has("sort_column")) {
                let column = params.get("sort_column");
                if (column === "company") {
                    document.getElementById('radio-' + params.get("sort")).checked = true
                } else {
                    document.getElementById('radio-sort-desc').checked = true
                }
            } else {
                document.getElementById('radio-sort-desc').checked = true
            }
        }
        document.addEventListener("DOMContentLoaded", function () {
            let searchbtn = document.querySelectorAll(".searchbtn");
            for (let i = 0; i < searchbtn.length; i++) {
                searchbtn[i].addEventListener("click", function (e) {
                    e.preventDefault();
                    searchbtn[i].disabled = true;
                    search();
                });
            }
        });
    </script>
</body>
</html>
